### 文件命名

- makefile或者Makefile



### Makefile规则

```C++
目标 ... : 依赖 ...
	命令(shell命令)
	...
注：需要tab缩进
```

目标：最终要生成的文件

依赖：生成目标所需要的文件或依赖

命令：通过执行命令对依赖操作生成目标

- 命令执行之前会检查规则中的依赖是否存在（默认检查makefile同级目录文件）
  - 如果依赖存在，执行命令
  - 如果不存在，向下检查其它规则，检查有没有一个规则是用来生成这个依赖的，如果有，执行该规则的命令。
- 检查更新，检查目标和依赖的时间是否一致
  - 如果依赖的时间比目标的时间晚，需要重新生成目标
  - 如果依赖的时间早于目标时间，目标不需要更新，对应规则的命令不需要执行

- 变量

  - 自定义变量

    ```
    变量名=变量值	var=hello
    ```

    

  - 预定义变量

    ```
    AR：归档维护程序的名称，默认值为ar
    
    CC：C编译器的名称，默认值为cc
    
    CXX：C++编译器的名称，默认值为g++
    
    $@：目标的完整名称
    
    $<：第一个依赖的名称
    
    $^：所有依赖的名称
    ```

    

  - 获取变量的值

    ```
    $(变量名)
    ```

- 模式匹配

  ```
  %.c : %.o
  	- % : 通配符，匹配一个字符串
  	- 两个%匹配的是同一个字符串
  %.c : %.o
  	$(cc) -c $< -o $@
  # $< 获取第一个依赖名称
    $@ 获取目标依赖名称
  ```

- 函数

  - ```
    $(wildcard PATTERN...) 
    功能：获取指定目录下指定类型的文件列表 
    
    参数：PATTERN 指的是某个或多个目录下的对应的某种类型的文件，如果有多个目录，一般使用空格间隔 
    
    返回：得到的若干个文件的文件列表，文件名之间使用空格间隔 
    
    eg：
    $(wildcard *.c ./sub/*.c) 
    返回值格式: a.c b.c c.c d.c e.c f.c
    ```

  - ```
    $(patsubst <pattern>,<replacement>,<text>)
    	功能：查找<text>中的单词(单词以“空格”、“Tab”或“回车”“换行”分隔)是否符合模式<pattern>，如果匹配的话，则以<replacement>替换。
    	<pattern>可以包括通配符`%`，表示任意长度的字串。如果<replacement>中也包含`%`，那么，<replacement>中的这个`%`将是<pattern>中的那个%所代表的字串。(可以用`\`来转义，以`\%`来表示真实含义的`%`字符)
    	返回：函数返回被替换过后的字符串
    	
    eg：
    $(patsubst %.c, %.o, x.c bar.c)
    返回值格式: x.o bar.o
    ```

    

  



